<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"
        />
        <link rel="stylesheet" href="style.css" />
        <link
            rel="stylesheet"
            href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"
        />
        <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script> -->
        <script
            src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"
        ></script>
        <script
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"
        ></script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
        />
        <script type="text/javascript" src="js/Stock_info/Stock_Div_Detail.js"></script>
        <script type="text/javascript" src="js/Finder_Stock/Finder_S_PER1.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_1.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_2.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_3.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_4.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_5.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_6.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_7.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_8.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_9.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_10.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_11.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_12.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_13.js"></script>
        <script type="text/javascript" src="js/Stock_info/Stock_info_14.js"></script>

        <title>좀 버는 남자</title>
    </head>

    <body>
        <section class="main" style="height: 69vh;">
            <div class="topnav">
                <a class="title" href="#"
                    ><img src="images/JBN_Logo.svg" alt="" style="height: 60px;"
                /></a>
            </div>
            <div class="dropdown">
                <!-- <div class="btn-group" role="group" aria-label="Basic example">
                    <button id="finder_stock_condition" onclick="dropdown_1()" class="dropbtn">검색조건</button>
                        <div id="myDropdown" class="dropdown-content">
                            <a onclick="Low_PER_1()">저PER</a>
                        </div>
                    <button id="finder_stock_condition" onclick="dropdown_2()" class="dropbtn">업종선택</button>
                        <div id="myDropdown2" class="dropdown-content">
                            <a onclick="Low_PER_1()">반도체와반도체장비</a>
                        </div>
                </div> -->
                
                <div class="btn-group" role="group" aria-label="Basic example">
                    <select id="Find_Stock_Condtion" >
                        <option value="Low_PER">저PER</option>
                        <option value="SRIM">S_RIM</option>
                    </select>
                    
                    <select id="inventory_WICS"></select>
                    
                    <button id="Finder" onclick="Search_Stock()">검색</button>
                </div>
            </div>
            <form role="form">
                개발중입니다.
                <div id="PER_FINDER_Result"  style="max-height: 50vh; overflow: auto;padding-top: 10px;" align="center" ></div>    
            </form>
        </section>

        <section class="banner_section" align="center">
            <ins
                class="kakao_ad_area"
                style="display: none;"
                data-ad-unit="DAN-1jyb0fd2si5v5"
                data-ad-width="320"
                data-ad-height="100"
            ></ins>
            <script
                type="text/javascript"
                src="//t1.daumcdn.net/kas/static/ba.min.js"
                async
            ></script>
        </section>

        <section>
            <div class="btn-group" role="group" aria-label="Basic example">
                <button
                    type="button"
                    class="button"
                    style="height: 10vh; width: 20vw;"
                    onclick="location.href='index.html';"
                >
                    목표주가
                </button>
                <button
                    type="button"
                    class="button"
                    style="height: 10vh; width: 20vw;"
                    onclick="location.href='Find_Stock.html';"
                >
                    종목발굴
                </button>
                <button
                    type="button"
                    class="button"
                    style="height: 10vh; width: 20vw;"
                    onclick="location.href='sector.html';"
                >
                    업종DATA
                </button>
                <button
                    type="button"
                    class="button"
                    style="height: 10vh; width: 20vw;"
                    onclick="location.href='data_lab.html';"
                >
                    데이터실
                </button>
                <button
                    type="button"
                    class="button"
                    style="height: 10vh; width: 20vw;"
                    onclick="location.href='help.html';"
                >
                    도움말
                </button>
            </div>
        </section>
        <footer class="footer" style="height: 3vh;">
            <div class="center_footer">
                <p>copyright&copy; 2020. 좀버남(주식아빠) all rights reserved.</p>
            </div>
        </footer>
    </body>
</html>

<script>
    function dropdown_1() {
        document.getElementById('myDropdown').classList.toggle('show');
    }
    function dropdown_2() {
        document.getElementById('myDropdown2').classList.toggle('show');
    }
    
    // Close the dropdown menu if the user clicks outside of it
    window.onclick = function (event) {
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName('dropdown-content');
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    };
    
    $(document).ready(function () {
        var stock_div_data = stock_div;
        
        var output = '<select>';
        for(var i=0;i<stock_div_data.length;i++){
            output += '<option value="'+ stock_div_data[i] + '">' + stock_div_data[i] +'</option>'
        }
        output += '</select>';
        $('#inventory_WICS').html(output);
    });
    
    function Search_Stock(){
        var Con_F_S = document.getElementById('Find_Stock_Condtion').value;
        var Div_F_ST = document.getElementById('inventory_WICS').value;
        if(Con_F_S == "Low_PER"){
            Low_PER_1(Div_F_ST);
        }
    }
    function sortTable() {
        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("Table_F_S");
        switching = true;
        /*Make a loop that will continue until
        no switching has been done:*/
        while (switching) {
            //start by saying: no switching is done:
            switching = false;
            rows = table.rows;
            /*Loop through all table rows (except the
            first, which contains table headers):*/
            for (i = 1; i < (rows.length - 1); i++) {
                //start by saying there should be no switching:
                shouldSwitch = false;
                /*Get the two elements you want to compare,
                one from current row and one from the next:*/
                x = rows[i].getElementsByTagName("TD")[3];
                y = rows[i + 1].getElementsByTagName("TD")[3];
                //check if the two rows should switch place:
                if (Number(x.innerHTML) > Number(y.innerHTML)) {
                    //if so, mark as a switch and break the loop:
                    shouldSwitch = true;
                    break;
                }
            }
            if (shouldSwitch) {
                /*If a switch has been marked, make the switch
                and mark that a switch has been done:*/
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
            }
          }
    }
</script>
<script type="text/javascript">
    function Low_PER_1(Div_F_ST) {
        var data1 = stock1;
        var data2 = stock2;
        var data3 = stock3;
        var data4 = stock4;
        var data5 = stock5;
        var data6 = stock6;
        var data7 = stock7;
        var data8 = stock8;
        var data9 = stock9;
        var data10 = stock10;
        var data11 = stock11;
        var data12 = stock12;
        var data13 = stock13;
        var data14 = stock14;
        var data_length =
            data1.length +
            data2.length +
            data3.length +
            data4.length +
            data5.length +
            data6.length +
            data7.length +
            data8.length +
            data9.length +
            data10.length +
            data11.length +
            data12.length +
            data13.length +
            data14.length;

        var data_stock_code = [];
        var data_stock_name = [];
        var data_stock_WICS = [];
        var data_stock_PER_RANK = [];
        var data_stock_stock_Div_PER = [];
        var data_stock_Current_PER = [];
        var data_stock_Current_PER_Rank = [];
        var n = 0;

        for (i = 0; i < data1.length; i++) {
            data_stock_code[n] = data1[i].s_c;
            data_stock_name[n] = data1[i].s_n;
            data_stock_WICS[n] = data1[i].s_W;
            data_stock_PER_RANK[n] = data1[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data2.length; i++) {
            data_stock_code[n] = data2[i].s_c;
            data_stock_name[n] = data2[i].s_n;
            data_stock_WICS[n] = data2[i].s_W;
            data_stock_PER_RANK[n] = data2[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data3.length; i++) {
            data_stock_code[n] = data3[i].s_c;
            data_stock_name[n] = data3[i].s_n;
            data_stock_WICS[n] = data3[i].s_W;
            data_stock_PER_RANK[n] = data3[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data4.length; i++) {
            data_stock_code[n] = data4[i].s_c;
            data_stock_name[n] = data4[i].s_n;
            data_stock_WICS[n] = data4[i].s_W;
            data_stock_PER_RANK[n] = data4[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data5.length; i++) {
            data_stock_code[n] = data5[i].s_c;
            data_stock_name[n] = data5[i].s_n;
            data_stock_WICS[n] = data5[i].s_W;
            data_stock_PER_RANK[n] = data5[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data6.length; i++) {
            data_stock_code[n] = data6[i].s_c;
            data_stock_name[n] = data6[i].s_n;
            data_stock_WICS[n] = data6[i].s_W;
            data_stock_PER_RANK[n] = data6[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data7.length; i++) {
            data_stock_code[n] = data7[i].s_c;
            data_stock_name[n] = data7[i].s_n;
            data_stock_WICS[n] = data7[i].s_W;
            data_stock_PER_RANK[n] = data7[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data8.length; i++) {
            data_stock_code[n] = data8[i].s_c;
            data_stock_name[n] = data8[i].s_n;
            data_stock_WICS[n] = data8[i].s_W;
            data_stock_PER_RANK[n] = data8[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data9.length; i++) {
            data_stock_code[n] = data9[i].s_c;
            data_stock_name[n] = data9[i].s_n;
            data_stock_WICS[n] = data9[i].s_W;
            data_stock_PER_RANK[n] = data9[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data10.length; i++) {
            data_stock_code[n] = data10[i].s_c;
            data_stock_name[n] = data10[i].s_n;
            data_stock_WICS[n] = data10[i].s_W;
            data_stock_PER_RANK[n] = data10[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data11.length; i++) {
            data_stock_code[n] = data11[i].s_c;
            data_stock_name[n] = data11[i].s_n;
            data_stock_WICS[n] = data11[i].s_W;
            data_stock_PER_RANK[n] = data11[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data12.length; i++) {
            data_stock_code[n] = data12[i].s_c;
            data_stock_name[n] = data12[i].s_n;
            data_stock_WICS[n] = data12[i].s_W;
            data_stock_PER_RANK[n] = data12[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data13.length; i++) {
            data_stock_code[n] = data13[i].s_c;
            data_stock_name[n] = data13[i].s_n;
            data_stock_WICS[n] = data13[i].s_W;
            data_stock_PER_RANK[n] = data13[i].s_P_R;
            n = n + 1;
        }
        for (i = 0; i < data14.length; i++) {
            data_stock_code[n] = data14[i].s_c;
            data_stock_name[n] = data14[i].s_n;
            data_stock_WICS[n] = data14[i].s_W;
            data_stock_PER_RANK[n] = data14[i].s_P_R;
            n = n + 1;
        }

        
        
        
        

        for (var i = 0; i < n; i++) {
            if(data_stock_WICS[i] == Div_F_ST && data_stock_PER_RANK[i] <=10){
                var detail_path = 'js/Stock_Det/' + data_stock_code[i] + '.json';
                $.getJSON(detail_path, function (jd) {
                data_stock_stock_Div_PER[i] = jd.stock_Div_PER;
                data_stock_Current_PER[i] = jd.Current_PER;
                data_stock_Current_PER_Rank[i] = jd.Current_PER_Rank;
                });    
            }
        }
        
        
        var data = stock_div;
        var output = '<div class="table-responsive">';
        output += '<table id="Table_F_S" class="table table-sm">';
        output += '<thread>';
        output += '<tr>';
        output += '<th scope="col"> # </th>';
        output += '<th scope="col"> 종목코드 </th>';
        output += '<th scope="col"> 종목명 </th>';
        output += '<th scope="col"> PER 순위 </th>';
        output += '<th scope="col"> PER </th>';
        output += '<th scope="col"> 업종 PER </th>';
        output += '<th scope="col"> 업종 </th>';
        output += '</tr>';
        output += '</thread>';
        output += '<tbody>';
        for (var i= 0;i<n;i++){
            if (data_stock_WICS[i] == Div_F_ST && data_stock_Current_PER[i] <= 10){
                output += '<tr>'
                output += '<th scope="row">' + i+1 + '</th>'
                output += '<td>' +  data_stock_code[i] + '</td>';
                output += '<td>' +  data_stock_name[i] + '</td>';
                output += '<td>' +  data_stock_Current_PER_Rank[i] + '</td>';
                output += '<td>' +  data_stock_Current_PER[i] + '</td>';
                output += '<td>' +  data_stock_stock_Div_PER[i] + '</td>';
                output += '<td>' +  data_stock_WICS[i] + '</td>';
                output += '</tr>'    
            }
        }
        output += '</tbody>';
        output += '</table>';
        output += '</div>';
        
        // alert(data_stock_Current_PER_Rank[0]);
        $('#PER_FINDER_Result').html(output);
        sortTable();
        

        
        
        
    }
    $.ajaxSetup({
    async: false
});
</script>
